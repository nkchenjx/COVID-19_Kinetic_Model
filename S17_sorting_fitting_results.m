clear;
load('data_SRIVB_fit.mat');

manualLable =[0
0
0
0
0
1
0
0
0
1
1
1
1
1
1
1
0
1
0
1
0
1
1
0
1
1
1
1
0
0
1
0
1
1
0
0
0
0
1
1
1
0
0
1
1
1
0
0
0
1
0
1
1
0
1
1
0
1
0
0
1
1
0
1
0
0
0
1
0
0
1
0
0
0
0
1
1
0
1
0
0
1
1
0
1
1
0
0
0
0
0
1
0
0
1
0
1
0
0
1
1
1
1
1
0
1
0
1
1
0
1
1
1
1
0
0
1
1
0
0
1
0
0
0
0
1
0
0
1
1
0
0
0
1
1
0
1
0
1
0
1
0
1
0
1
1
1
1
0
1
0
0
0
0
0
1
0
1
1
0
0
0
1
0
1
0
0
0
1
1
1
0
0
0
1
0
1
1
1
0
1
1
0
1
0
1
1
0
0
0
0
0
0
0
0
0
1
0
1
0
0
1
1
0
1
1
1
1
0
0
0
1
1
0
1
1
0
0
1
1
0
0
0
0
1
0
0
0
0
1
1
1
0
1
0
0
0
1
1
1
0
1
1
0
0
0
1
1
0
0
1
0
1
0
];

manualLable2 = [
0
0
0
0
0
1
0
0
1
1
1
1
1
1
1
1
0
1
1
1
0
1
1
0
1
1
1
1
0
1
1
0
1
1
0
0
1
0
1
1
1
0
0
1
1
1
0
0
0
1
0
1
1
0
1
1
0
1
0
0
1
1
0
0
0
0
0
1
0
0
1
1
0
0
1
1
1
0
1
0
0
1
1
0
1
1
0
0
0
0
0
1
0
0
1
0
1
1
0
1
1
1
1
1
0
1
1
1
1
0
1
1
1
1
0
0
1
1
0
0
1
0
0
0
0
1
0
0
1
1
0
0
0
1
1
0
1
0
0
0
1
0
1
0
1
1
1
1
0
1
0
0
0
0
0
1
1
1
1
0
0
0
1
0
1
0
0
0
1
1
1
0
0
0
1
0
1
1
1
0
1
1
0
1
1
1
1
1
1
0
0
1
0
0
1
0
1
0
1
0
0
1
1
0
1
1
1
1
0
0
0
1
1
0
1
1
0
1
1
1
0
0
0
0
1
0
0
0
0
1
1
1
0
1
0
0
0
1
1
1
0
1
1
0
0
0
1
1
0
0
1
0
0
0
];

group1= [
    1

3
4

7
8
17
21
24
29
32
35
36
38
42
43
47
48

51
54
57
59

63
64

66
67
69
70

74
78
80
81
84

88
89
90
91
93
94
96

105
110
115



122
123
124
125
127


132
133
136
138
139
140
142

149
151
152
153

155
160
161




168
172

174
176

183

191
193
194
196
198

201
204

210
211
214
217
221

223

226
227




236
237
241





252
253
254
];

group2 = [6
9
10
11
12

14
15
16
18
19
20
22
23
25
26
27
28
30
31
33
34
37
39
40
41
44
45
46
50
52
53
55
56
58
61
62
68


75
76
77
79
82
83
85
86
92
95

98
100
101
102
103
104
106
107
108
109
111
112
113
114

118
121
126

130
134
135
137
141
143
145
146
147
148
150
156
157
158
159

165
169

171
175
177
178
179
181
182
184
185
186
187
188
189
192
195
197
199
202
203
205
206
207
208

213
215
216
218
219
220
225
230
231
232
234
238
239
240

243
247
248
];

country1 = country(group1);
country2 = country(group2);



R0 = 3.0;
group1_1 = [];
group1_2 = [];
% for c = 1:length(group1)
%     Icumu = cumsum(country1(c).ncspm);
%     Vcumu = country1(c).pfvpm;
%     Im = Icumu*option.gamma0 + Vcumu;
%     country1(c).Immune = Im;
%     if Im(940)/1E6> (1-1/R0)
%         fprintf([num2str(c), ' immune on day 940 > 2/3', '\n']);
%         group1_1 =[group1_1; c];
%         % figure; plot(Im); hold on; plot(Icumu); plot(Vcumu);
%         % figure; plot(country1(c).SIRVB.Rt); hold on; plot(country1(c).stringency_index); title(country1(c).country);
%     else
%         group1_2 =[group1_2; c];
%     end
%     if Im(end) > 1E6
%         fprintf([num2str(c), ' immune on last day > 1', '\n']);
%     end
%     country1(c).maxIm = Im(end);
% end


% country1_2 = country1(group1_2);
country1_2 = country1;


